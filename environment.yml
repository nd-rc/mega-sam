name: mega_sam
channels:
  - pytorch-nightly
  - nvidia/label/cuda-12.6.0  # Канал с компиляторами
  - conda-forge
  - defaults
dependencies:
  - python=3.10
  - pip
  - git
  - ninja  # Ускоритель сборки
  
  # === CUDA и PyTorch (Nightly для RTX 5070) ===
  - pytorch
  - torchvision
  - torchaudio
  - pytorch-cuda=12.8
  - cuda-toolkit  # Компилятор NVCC (критично!)
  - pip:
    # База
    - numpy<2.0  # ВАЖНО: Фикс для pycolmap/gsplat
    - scipy
    - matplotlib
    - tqdm
    - opencv-python
    - imageio
    - imageio-ffmpeg
    
    # Для Gsplat / Nerfstudio
    - pyyaml
    - viser
    - lpips
    - tyro
    - tensorboard
    - jaxtyping
    - rich
    
    # NOTE: torch-scatter и сам mega-sam устанавливаются отдельно,
    # так как требуют флага --no-build-isolation, который YAML плохо поддерживает.